<Lems
      xmlns="http://www.neuroml.org/lems/0.7.4"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.neuroml.org/lems/0.7.4 ../../LEMS/Schemas/LEMS/LEMS_v0.7.4.xsd"
      description="A number of ComponentTypes for rate based/population models">

    <ComponentType name="Kuramoto"
                   description="Base type of any cell/population which has a (dimensionless) rate _R."
                   value="none">

        <!-- Parameters will be assumed to be swept. sweep data will be matched by order of entry -->
        <Parameter name="global_coupling" dimension='float'/>
        <Parameter name="global_speed" dimension='float'/>

        <Requirement name="MODEL_LIMIT" dimension="2_pi"/> <!-- put helping functions in util, select wrapping functions.  -->
        
        <Exposure name="V" dimension="sin(V)"/>

        <Dynamics>
            <StateVariable name="V" dimension="PI-V, PI"/>

            <DerivedVariable name="rec_n" dimension="none" value="1.0f / n_node" />
            <DerivedVariable name="rec_speed_dt" dimension="1/distance" value="1.0f / global_speed / (dt)" />
            <DerivedVariable name="omega" dimension="MHz" value="60.0 * 2.0 * M_PI_F / 1e3" />
            <DerivedVariable name="nsig" dimension="none" value="sqrt(dt) * sqrt(2.0 * 1e-5)" />

            <TimeDerivative variable="dV" exposure="dV" value="omega * c_0"/>
        </Dynamics>

    </ComponentType>

    <ComponentType name="coupling_function">

<!--        Added function for pre and post synaptic activity. Fixed the power being **, however no parse checks for it-->

        <Constant name="a" symbol="NArray" dimension="lo=0.0, hi=10., step=0.1" value="0.1" description="Rescales the connection strength."/>

<!--        variables for pre synaptic function-->
        <Parameter name="V" dimension=''/>
        <Parameter name="V_j" dimension=''/>

<!--        variables for post synaptic function-->
        <Requirement name="wij" dimension=''/>

        <Function name="pre" value="sin(V_j - V)" description = "pre synaptic function for coupling activity"/>
        <Function name="post" value="wij" description = "post synaptic function for coupling activity"/>

        <!-- Handle local coupling result, full expression is c_0 *= 'value'. Name option is hardcoded -->
        <DerivedParameter name="c_0" value="global_coupling * rec_n"/>

    </ComponentType>

    <ComponentType name="noise">

<!--        Param a-->
<!--        Related to exposures?-->

<!--        StateVariables for certain noises-->
<!--        parant noise of specific children-->
<!--        ScalingFunction GFUN; noisescaling-->

<!-- dimension field for Constant is being (mis)used for fields required for Float (True or False), domain for NArray (lo, hi, step) or field_type for Attr ('str') ) -->
<!--        is label more than a short description? -->

        <Constant name="ntau" symbol="Float" dimension="True" value="0.1" description="The noise correlation time"/>
        <Constant name="noise_seed" symbol="Int" dimension="" value="42" description="A random seed used to initialise the random_stream if it is missing."/>
        <Constant name="random_stream" symbol="Attr" dimension="numpy.random.RandomState" value="0.0" description="An instance of numpy's RandomState associated with this
            specific Noise object. Used when you need to resume a simulation from a state saved to disk"/>
<!--        <Requirement name="temperature" dimension="temperature"/>-->

    </ComponentType>


</Lems>
